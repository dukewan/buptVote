ctx=$("#myChart").get(0).getContext("2d");myChart=new Chart(ctx);data={labels:["","","","","","","","","",""],datasets:[{fillColor:"rgba(18,170,235,0.7)",strokeColor:"rgba(18,170,235,1)",data:[,,,,,,,,,]},]};options={scaleOverlay:false,scaleOverride:true,scaleSteps:20,scaleStepWidth:10,scaleStartValue:0,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:true,scaleLabel:"<%=value+'票'%>",scaleFontFamily:"'微软雅黑'",scaleFontSize:13,scaleFontStyle:"bold",scaleFontColor:"#666",scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:true,barStrokeWidth:2,barValueSpacing:10,barDatasetSpacing:1,animation:true,animationSteps:60,animationEasing:"easeOutQuart",onAnimationComplete:null,};function setOptions(a){var b;if(a<90&&a>40){b=parseInt((parseInt(a/18)+8)/10)*10}else{b=parseInt((parseInt(a/15)+5)/10)*10}if(b<10){b=2}options.scaleStepWidth=b}function setLables(a){for(var b=0;b<=a.length-1;b++){$("#label_name_"+(b+1)).html(a[b])}}function getTop10Data(b){var a=$.ajax({url:b,type:"POST",error:function(e,d,f){alert("给服务器跪了 -_-#")},success:function(){var f=$.parseJSON(a.responseText);var d=new Array(10);var c=f.length;for(var e=0;e<=c-1;e++){d[e]=f[e][1];data.datasets[0]["data"][e]=f[e][2]}setLables(d);setOptions(data.datasets[0]["data"][0]);myChart.Bar(data,options)}})}function drawChart(){var a=$("#url").attr("data-url");getTop10Data(a);window.setInterval(function(){getTop10Data(a)},10000)}$(document).ready(function(){drawChart()});